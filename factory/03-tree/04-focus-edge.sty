% == PACKAGES USED == %

\RequirePackage{simplekv}


% == DEFINITIONS == %

\newcommand\ptreeFocus{\@ifstar{\tnsproba@ptree@focus@star}{\tnsproba@ptree@focus@no@star}}

\newcommand\tnsproba@ptree@focus@star{\@ifstar{\tnsproba@ptree@focus@star@star}{\tnsproba@ptree@focus@star@no@star}}


\newcommand\tnsproba@ptree@focus@color{blue}


% #1 : number of the node
% #2 : the node
\newcommand\tnsproba@ptree@focus@abstract@node[2]{
	\node[draw       = \tnsproba@ptree@focus@color,
          line width = 1.5pt,
          inner sep  = 0pt,
          rounded corners,
          fit = (#2)(#2)(#2)] {};
}


% #1 : number of the node
% #2 : the node
\newcommand\tnsproba@ptree@focus@abstract@node@nostart[2]{
	\ifnum#1=1\else
    	\tnsproba@ptree@focus@abstract@node{#1}{#2}
    \fi
}


% #1 : node1 | node2 | ...
\newcommand\tnsproba@ptree@focus@abstract@multi@nodes[1]{
% Note
%
%    #1 : macro to apply
%    #2 : multi-args
	\tns@multi@apply@each%
	    {\tnsproba@ptree@focus@abstract@node}%
	    {#1}
}


\newcommand\tnsproba@ptree@focus@abstract@multi@nodes@nostart[1]{
	\tns@multi@apply@each%
	    {\tnsproba@ptree@focus@abstract@node@nostart}%
	    {#1}
}



% #1 : number of the couple of nodes
% #2 : start of the edge
% #3 : end   of the edge
\newcommand\tnsproba@ptree@focus@abstract@edge[3]{
    \draw[\tnsproba@ptree@focus@color,
          line cap   = round,
          line width = 1.5pt] 
    	 (#2.parent anchor) -- (#3.child anchor);
}


% #1 : node1 | node2 | ...
\newcommand\tnsproba@ptree@focus@abstract@multi@edges[1]{
% Note
%
%    #1 : macro to apply
%    #2 : multi-args
	\tns@multi@apply@overlapping@couples%
	    {\tnsproba@ptree@focus@abstract@edge}%
	    {#1}
}



\setKVdefault[tnsproba@focus@keys]{%
    col = blue
}

% #1 : color
% #2 : node1 | node2 | ...
\newcommand\tnsproba@ptree@focus@star@no@star[2][]{
    \useKVdefault[tnsproba@focus@keys]%
    \setKV[tnsproba@focus@keys]{#1}%
    \edef\col{\useKV[tnsproba@focus@keys]{col}}%
	\renewcommand\tnsproba@ptree@focus@color{\col}
	\tnsproba@ptree@focus@abstract@multi@edges{#2}
	\tnsproba@ptree@focus@abstract@multi@nodes@nostart{#2}
}

% #1 : color
% #2 : node1 | node2 | ...
\newcommand\tnsproba@ptree@focus@no@star[2][]{
    \useKVdefault[tnsproba@focus@keys]%
    \setKV[tnsproba@focus@keys]{#1}%
    \edef\col{\useKV[tnsproba@focus@keys]{col}}%
	\renewcommand\tnsproba@ptree@focus@color{\col}
	\tnsproba@ptree@focus@abstract@multi@edges{#2}
	\tnsproba@ptree@focus@abstract@multi@nodes{#2}
}

% #1 : color
% #2 : node1 | node2 | ...
\newcommand\tnsproba@ptree@focus@star@star[2][]{
    \useKVdefault[tnsproba@focus@keys]%
    \setKV[tnsproba@focus@keys]{#1}%
    \edef\col{\useKV[tnsproba@focus@keys]{col}}%
	\renewcommand\tnsproba@ptree@focus@color{\col}
	\tnsproba@ptree@focus@abstract@multi@edges{#2}
}
