\documentclass[12pt,a4paper]{article}

\makeatletter
    \input{../config/header[fr].sty}

    \usepackage{01-tree}
\makeatother


% == EXTRAS == %


\begin{document}

\section{Arbres pondérés}

\subsection{Que se passe-t-il en coulisse ?}

Le gros du travail est fait par le package \verb+forest+ qui utilise \verb+TiKz+. On peut donc faire appel à la machinerie de ce dernier et obtenir des choses sympathiques comme nous allons le voir ci-dessous.


% ---------------------- %


\subsection{Sans cadre}

\newparaexample{Le cas type}

Dans le code suivant l'environnement \verb+probatree+ utilise en coulisse celui nommé \verb+forest+ du package \verb+forest+. Des réglages spécifiques sont faits pour obtenir le résultat ci-après.
À cela s'ajoutent les styles spéciaux \verb+pweight+, \verb+apweight+ et \verb+bpweight+ qui facilitent l'écriture des pondérations sur les branches
\footnote{
    \texttt{pweight} vient de \emph{\og probability \fg} et \emph{\og weight\fg} soit \emph{\og probabilité \fg} et \emph{\og poids\fg} en anglais.
    Quant à \texttt{a} et \texttt{b} au début de \texttt{apweight} et \texttt{bpweight} respectivement, ils viennent de \emph{\og above \fg} et \emph{\og below\fg} soit \emph{\og dessus \fg} et \emph{\og dessous\fg} en anglais.
}.

\begin{latexex}
\begin{probatree}
    [
        [$A$, pweight = $a$
            [$B$, pweight = $b$]
            [$C$, pweight = $c$]
        ]
        [$D$, bpweight = $d$
            [$E$, apweight = $e$]
            [$F$, bpweight = $f$]
        ]
    ]
\end{probatree}
\end{latexex}


% ---------------------- %


\newparaexample{Des poids cachés partout}

On peut cacher tous les poids via l'environnement étoilé \verb+probatree*+ sans avoir à les effacer partout dans le code \LaTeX.

\begin{latexex}
\begin{probatree*}
    [$A$, pweight = $a$
        [$B$, pweight = $b$]
        [$C$, pweight = $c$]
    ]
\end{probatree*}
\end{latexex}


% ---------------------- %


\newparaexample{Des poids cachés localement}

Pour ne cacher que certains poids, il faudra utiliser localement le style \verb+pweight*+ comme dans l'exemple ci-dessous.

\begin{latexex}
\begin{probatree}
    [
        [$A$, pweight = $a$
            [$B$, pweight* = $b$]
            [$C$, pweight  = $c$]
        ]
        [$D$, pweight* = $d$]
    ]
\end{probatree}
\end{latexex}


% ---------------------- %


\newparaexample{Un signe $=$ et/ou une virgule dans les étiquettes}

Vous ne pouvez pas utiliser directement un signe $=$ ou une virgule dans les étiquettes des branches.
Pour contourner cette limitation, il suffit de mettre le contenu de l'étiquette dans des accolades.

\begin{latexex}
\begin{probatree}
    [
        [$A$, apweight = {$a = 0,1$}]
        [$B$, bpweight = $b$]
    ]
\end{probatree}
\end{latexex}


% ---------------------- %


\subsection{Avec des cadres}

\newparaexample{Des cadres facilement}

Via la clé \verb+frame+, il est très aisé d'encadrer un sous-arbre final
\footnote{
	Un sous-arbre sera dit final si toutes ses feuilles correspondent à des feuilles de l'arbre initial. 
}
comme le montre l'exemple suivant. Dans l'exemple ci-après nous utilisons la bidouille \verb+{},s sep = 1.3cm+ qui évite que les cadres se superposent.

\begin{latexex}
\begin{probatree}
    [{}, s sep = 1.3cm 
     % Astuce pour espacer les cadres.
        [$A$, pweight = $a$,
              frame   = red
            [$B$, pweight = $b$]
            [$C$, pweight = $c$]
        ]
        [$D$, pweight = $d$,
              frame   = blue
            [$E$, pweight = $e$
                [$F$, pweight = $f$]
                [$G$, pweight = $g$]
            ]
            [$H$, pweight = $h$
                [$I$, pweight = $i$]
                [$J$, pweight = $j$]
            ]
        ]
    ]
\end{probatree}
\end{latexex}


% ---------------------- %


\newparaexample{Des cadres faits à la main}


La macro \macro{ptreeFrame} permet facilement d'encadrer un sous-arbre non final.
Ceci nécessite de nommer les noeuds mais c'est facile à faire.
Voici un exemple où la macro \macro{ptreeFrame} attend les noms de la racine et des deux noeuds finaux le plus haut et le plus bas.

\begin{latexex}
\begin{probatree}
    [{}, name = nU
        [$A$, pweight = $a$,
              name    = nA
            [$B$, pweight = $b$,
                  name    = nB
                [$C$, pweight = $c$]
                [$D$, pweight = $d$]
               ]
            [$F$, pweight = $f$,
                  name    = nF]
        ]
        [$G$, pweight = $g$,
              name    = nG]
    ]
    \ptreeFrame        {nU}{nA}{nG}]
    \ptreeFrame[orange]{nA}{nB}{nF}]
\end{probatree}
\end{latexex}







% ---------------------- %


%\paragraph{Exemple 7 -- Indiquer un chemin}
%
%L'exemple suivant demande un peu plus d'implication mais de nouveau tout est obtenu via la machinerie de \verb+TiKz+.
%
%\begin{latexex}
%\begin{probatree}
%    [{}, name = start
%        [$A$, pweight = $a$, 
%              name    = nA
%            [$B$, pweight = $b$]
%            [$C$, pweight = $c$,
%                  name    = nC]
%        ]
%        [$D$, pweight = $d$,
%            [$E$, pweight = $e$]    
%            [$F$, pweight = $f$]
%        ]
%    ]
%    \draw[blue,
%          rounded corners,
%          dashed,
%          line width=0.7pt]          
%    (start.90) --
%    (nA.135) --
%    (nA.45) --
%    (nC.45) --
%    (nC.315) --
%    (nC.225) --
%    (nA.315) --
%    (nA.225) --
%    (start.315) --
%    (start.180) --
%    (start.90);
%\end{probatree}
%\end{latexex}


% ---------------------- %


\section{Fiches techniques}

\IDenv*{probatree }

\IDenv*{probatree*}

\Content{} un arbre codé en utilisant la syntaxe supportée par le package \verb+forest+.

\IDkey{pweight } pour écrire un poids sur le milieu d'une branche.

\IDkey{apweight} pour écrire un poids au-dessus le milieu d'une branche.

\IDkey{bpweight} pour écrire un poids en-dessous du milieu d'une branche.

\IDkey{frame} pour encadrer un sous-arbre depuis un noeud vers toutes les feuilles de celui-ci.


\separation


\IDmacro{ptreeFrame}{1}{3} \hfill \mwhyprefix{p}{robabilty}

\IDoption{} la couleur au format TikZ. La valeur par défaut est \verb#blue#.

\IDarg{$\!$s 1..3} noms de la sous-racine (à gauche), du noeud final en haut (à droite) et du noeud final en bas (à droite). Ici l'ordre n'est pas important.

\end{document}
