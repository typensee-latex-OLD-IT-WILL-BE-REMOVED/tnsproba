%\documentclass[12pt,a4paper]{scrartcl}
\documentclass[12pt,a4paper]{article}

\makeatletter % Technical doc - START

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{ucs}

\usepackage[french]{babel,varioref}

\usepackage[top=2cm, bottom=2cm, left=1.5cm, right=1.5cm]{geometry}
\usepackage{enumitem}

\usepackage{pgffor}

\usepackage{multicol}

\usepackage{makecell}

\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\usepackage{amsthm}

\usepackage{tcolorbox}
\tcbuselibrary{listingsutf8}

\usepackage{ifplatform}

\usepackage{ifthen}

\usepackage{macroenvsign}


% Sections numbering

\renewcommand\thesection{\arabic{section}.}
\renewcommand\thesubsection{\alph{subsection}.}
\renewcommand\thesubsubsection{\roman{subsubsection}.}


% MISC

\newtcblisting{latexex}{%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
	listing side text
}

\newtcbinputlisting{\inputlatexex}[2][]{%
	listing file={#2},%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
	listing side text
}


\newtcblisting{latexex-flat}{%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
}

\newtcbinputlisting{\inputlatexexflat}[2][]{%
	listing file={#2},%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
}


\newtcblisting{latexex-alone}{%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
	listing only
}

\newtcbinputlisting{\inputlatexexalone}[2][]{%
	listing file={#2},%
	sharp corners,%
	left=1mm, right=1mm,%
	bottom=1mm, top=1mm,%
	colupper=red!75!blue,%
	listing only
}


\newcommand\inputlatexexcodeafter[1]{%
	\begin{center}
		\input{#1}
	\end{center}

	\vspace{-.5em}
	
	Le rendu précédent a été obtenu via le code suivant.
	
	\inputlatexexalone{#1}
}


\newcommand\inputlatexexcodebefore[1]{%
	\inputlatexexalone{#1}
	\vspace{-.75em}
	\begin{center}
		\textit{\footnotesize Rendu du code précédent}
		
		\medskip
		
		\input{#1}
	\end{center}
}


\newcommand\env[1]{\texttt{#1}}
\newcommand\macro[1]{\env{\textbackslash{}#1}}



\setlength{\parindent}{0cm}
\setlist{noitemsep}

\theoremstyle{definition}
\newtheorem*{remark}{Remarque}

\usepackage[raggedright]{titlesec}

\titleformat{\paragraph}[hang]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{0.5em}


\newcommand\separation{
	\medskip
	\hfill\rule{0.5\textwidth}{0.75pt}\hfill
	\medskip
}


\newcommand\extraspace{
	\vspace{0.25em}
}


\newcommand\whyprefix[2]{%
	\textbf{\prefix{#1}}-#2%
}

\newcommand\mwhyprefix[2]{%
	\texttt{#1 = #1-#2}%
}

\newcommand\prefix[1]{%
	\texttt{#1}%
}


\newcommand\inenglish{\@ifstar{\@inenglish@star}{\@inenglish@no@star}}

\newcommand\@inenglish@star[1]{%
	\emph{\og #1 \fg}%
}

\newcommand\@inenglish@no@star[1]{%
	\@inenglish@star{#1} en anglais%
}


\newcommand\ascii{\texttt{ASCII}}


% Example
\newcounter{paraexample}[subsubsection]

\newcommand\@newexample@abstract[2]{%
	\paragraph{%
		#1%
		\if\relax\detokenize{#2}\relax\else {} -- #2\fi%
	}%
}



\newcommand\newparaexample{\@ifstar{\@newparaexample@star}{\@newparaexample@no@star}}

\newcommand\@newparaexample@no@star[1]{%
	\refstepcounter{paraexample}%
	\@newexample@abstract{Exemple \theparaexample}{#1}%
}

\newcommand\@newparaexample@star[1]{%
	\@newexample@abstract{Exemple}{#1}%
}


% Change log
\newcommand\topic{\@ifstar{\@topic@star}{\@topic@no@star}}

\newcommand\@topic@no@star[1]{%
	\textbf{\textsc{#1}.}%
}

\newcommand\@topic@star[1]{%
	\textbf{\textsc{#1} :}%
}

\makeatother % Technical doc - END


\usepackage{tnsproba}


\begin{document}

\renewcommand\labelitemi{\raisebox{0.125em}{\tiny\textbullet}}
\renewcommand{\labelitemii}{---}

\title{  %
	Le package \texttt{tnsproba}:\\%
	parler des probabilités facilement\\%
	{\footnotesize Code source disponible sur \url{https://github.com/typensee-latex/tnsproba.git}.}\\%
{\footnotesize Version \texttt{0.4.0-beta} développée et testée sur \macosxname{}.}%
}
\author{Christophe BAL}
\date{2020-07-31}

\maketitle


\vspace{2em}

\hrule

\tableofcontents

\vspace{1.5em}

\hrule

\newpage

\section{Introduction}

Le package \verb+tnsproba+ propose des macros utiles quand l'on parle de probabilités. La saisie se veut sémantique et simple.


% tnscom used - START
\section{Beta-dépendance}

\verb#\tnscom# qui est disponible sur \url{https://github.com/typensee-latex/tnscom.git} est un package utilisé en coulisse.
% tnscom used - END
% List of packages - START
\section{Packages utilisés}

La roue ayant déjà été inventée, le package \verb#tnsproba# réutilise les packages suivants sans aucun scrupule.

\begin{multicols}{4}
    \begin{itemize}
        \item \verb#amsmath#
        \item \verb#forest#
    \end{itemize}
\end{multicols}
% List of packages - END
\section{Ensembles probabilistes}

Le package \verb+tnssets+ propose le macro \macro{setproba} pour indiquer des ensembles de type probabiliste.
Se rendre sur \url{https://github.com/typensee-latex/tnssets.git} si cela vous intéresse.
\section{Généralités}

\subsection{Probabilité \og simple \fg}

\newparaexample{}

\begin{latexex}
$\proba{A}$
\end{latexex}


% ---------------------- %


\newparaexample{Choisir le nom de la probabilité}

\begin{latexex}
$\proba[P]{A}$
\end{latexex}


% ---------------------- %


\subsection{Probabilité conditionnelle}

\newparaexample{Les deux écritures classiques}

La 1\iere{} notation, qui est devenue standard, permet de comprendre l'ordre des arguments.
\begin{latexex}
 $\probacond {B}{A}
= \probacond*{B}{A}$
\end{latexex}


% ---------------------- %


\newparaexample{Obtenir la formule de définition}

Le préfixe \prefix{e} est pour \whyprefix{e}{xpand} soit \inenglish{développer}
\footnote{
	Pour ne pas alourdir l'utilisation de \macro{probacond}, il a été choisi d'utiliser un préfixe au lieu d'un système de multi-options.
}.

\begin{latexex}
 $\eprobacond {B}{A}
= \eprobacond*{B}{A}$
\end{latexex}


% ---------------------- %


\newparaexample{Choisir le nom de la probabilité}

\begin{latexex}
 $\probacond  [P]{B}{A}
= \probacond* [P]{B}{A}
= \eprobacond*[P]{B}{A}
= \eprobacond [P]{B}{A}$
\end{latexex}


% ---------------------- %
%\section{Généralités}

\subsection{Évènement contraire}

\macro{nevent} vient de \whyprefix{n}{ot} \prefix{event} qui est une pseudo-traduction de \inenglish{évènement contraire}.
\begin{latexex}
$\nevent{A}$
\end{latexex}


% ---------------------- %
%\section{Généralités}

\subsection{Espérance, variance et écart-type}

\newparaexample{Espérance}

\macro{expval} vient de \whyprefix{exp}{ected} \whyprefix{val}{ue} soit \inenglish{espérance}.
\begin{latexex}
$\expval{X}$
\end{latexex}


% ---------------------- %


\newparaexample{Choisir le nom de l'espérance}

\begin{latexex}
$\expval[E_1]{X}$
\end{latexex}


% ---------------------- %


\newparaexample{Variance}

\begin{latexex}
$\var   {X}$ ou
$\var[v]{X}$
\end{latexex}


% ---------------------- %


\newparaexample{Écart-type}

\macro{stddev} vient de \whyprefix{st}{andar-}\prefix{d} \whyprefix{dev}{iation} soit \inenglish{écart-type}.
\begin{latexex}
$\stddev   {X}$ ou
$\stddev[s]{X}$
\end{latexex}


% ---------------------- %
\section{Arbres pondérés}

\subsection{Que se passe-t-il en coulisse ?}

Le gros du travail est fait par le package \verb+forest+ qui utilise \verb+TiKz+. On peut donc faire appel à la machinerie de ce dernier et obtenir des choses sympathiques comme ci-dessous à moindre coût neuronal.

\inputlatexexcodeafter{tikz/probatree-showcase.tkz}


% ---------------------- %


\subsection{Les bases}

\newparaexample{Le cas type}

Commençons par un arbre nu pour voir comment utiliser l'environnement \verb+probatree+ qui s'appuie en coulisse sur celui nommé \verb+forest+ du package éponyme.
L'exemple qui suit utilise juste les réglages spécifiques de mise en forme de l'arbre qui sont propres à \verb+probatree+.

\inputlatexex{tikz/probatree-undecorated.tkz}


% ---------------------- %


\newparaexample{Ajouter des pondérations}

Dans le code suivant, ce sont les styles spéciaux supplémentaires \verb+pweight+, \verb+apweight+ et \verb+bpweight+ qui facilitent l'écriture des pondérations sur les branches
\footnote{
    \prefix{pweight} vient de \whyprefix{p}{robability} et \prefix{weight} soit \inenglish*{probabilité} et \inenglish{poids}.
    Quant au \prefix{a} et au \prefix{b} au début de \prefix{apweight} et \prefix{bpweight} respectivement, ils viennent de \whyprefix{a}{bove} et \whyprefix{b}{elow} soit \inenglish*{dessus} et \inenglish{dessous}.
}.

\inputlatexex{tikz/probatree-weight-placement.tkz}


% ---------------------- %


\newparaexample{Des poids cachés partout}

On peut cacher tous les poids via l'environnement étoilé \verb+probatree*+ sans avoir à les effacer partout dans le code \LaTeX{} \emph{(ceci peut être utile lors de la rédaction d'exercices)}.

\inputlatexex{tikz/probatree-weight-hide-all.tkz}


% ---------------------- %


\newparaexample{Des poids cachés localement}

Pour ne cacher que certains poids afin de produire par exemple un arbre à compléter, il faudra utiliser localement le style \verb+pweight*+ comme dans l'exemple ci-dessous.

\inputlatexex{tikz/probatree-weight-hide-locally.tkz}


% ---------------------- %


\newparaexample{Un signe $=$ et/ou une virgule dans les étiquettes}

Vous ne pouvez pas utiliser directement un signe $=$ ou une virgule dans les étiquettes des branches
\footnote{
	Ces deux symboles font partie de la syntaxe TikZ.
}.
Pour contourner cette limitation, il suffit de mettre le contenu de l'étiquette entre des accolades.

\inputlatexex{tikz/probatree-weight-coma-equal.tkz}
%\section{Arbres pondérés}

\subsection{Commenter les racines}

Que ce soit pour expliquer un arbre de probabilité, ou bien pour raisonner sur ce dernier, l'effet suivant est très utile.
Noter qu'ici il a fallu utiliser des accolades pour cacher à TikZ les signes $=$ dans les commentaires.


\inputlatexexflat{tikz/probatree-comment.tkz}


\begin{remark}
	Commenter un noeud interne ne provoquera pas d'erreur même si \verb#pcomment# n'a pas été conçu pour ceci.
	Ceci a été utilisé dans l'exemple d'introduction mais ça reste un petit hack.
\end{remark}
%\section{Arbres pondérés}

\subsection{Avec des cadres}

\newparaexample{Des cadres finaux}

Via la clé \verb#pframe# il est très aisé d'encadrer un sous-arbre final
\footnote{ 
	Un sous-arbre sera dit final si toutes ses feuilles correspondent à des feuilles de l'arbre initial. 
}
comme le montre l'exemple suivant. Dans l'exemple ci-après nous utilisons la bidouille \verb+{},s sep = 1.3cm+ qui évite que les cadres se superposent.

\inputlatexex{tikz/probatree-frame-final.tkz}


% ---------------------- %


\newparaexample{Des cadres non finaux}


La macro \macro{ptreeFrame} permet facilement d'encadrer un sous-arbre non final.
Ceci nécessite de nommer les noeuds mais c'est facile à faire.
Voici un exemple où la macro \macro{ptreeFrame} attend les noms de la racine et des deux noeuds finaux le plus haut et le plus bas qui sont ajoutés via \verb#name = ...# dans le code de l'arbre.

\inputlatexex{tikz/probatree-frame-not-final.tkz}
%\section{Arbres pondérés}

\subsection{Mettre en valeur des chemins}

Il est relativement aisé de mettre en valeur un chemin particulier comme dans l'exemple ci-après qui est une simple démo. montrant les différences entre \macro{ptreeFocus},  \macro{ptreeFocus*} et \macro{ptreeFocus**}.

\inputlatexex{tikz/probatree-focus-edge.tkz}

Voici ce qu'il faut retenir.

\begin{enumerate}
	\item \macro{ptreeFocus} encadre les noeuds initial et final.

	\item \macro{ptreeFocus*} encadre juste le noeud final.

	\item \macro{ptreeFocus**} n'encadre aucun des deux noeuds.
	
	\item La couleur peut être changée via l'argument optionnel. Par défaut le bleu est utilisé.
\end{enumerate}
%\section{Arbres pondérés}
\newpage

\section{Historique}

Nous ne donnons ici qu'un très bref historique récent
\footnote{
	On ne va pas au-delà de un an depuis la dernière version.
}
de \verb+tnsproba+ à destination de l'utilisateur principalement.
Tous les changements sont disponibles uniquement en anglais dans le dossier \verb+change-log+ : voir le code source de \verb+tnsproba+ sur \verb+github+.

\begin{description}
% Changes shown - START

    \medskip
    \item[2020-07-31] Nouvelle version mineure \verb+0.4.0-beta+.
    
    \begin{itemize}[itemsep=.5em]
        \item \topic*{Arbre}
        	  possibilité de mettre en valeur un chemin via \macro{ptreeFocus},  \macro{ptreeFocus*} ou \macro{ptreeFocus**}.
    \end{itemize}
    
    \separation
% ------------------------ %

    \medskip
    \item[2020-07-25] Nouvelle version mineure \verb+0.3.0-beta+.
    
    \begin{itemize}[itemsep=.5em]
        \item \topic{Arbre}
        \begin{itemize}[itemsep=.5em]
            \item Ajout du style \prefix{pcomment} pour placer du texte à la droite d'une feuille.
    
            \item Le style \prefix{frame} a été renommé \prefix{pframe}.
        \end{itemize}
    \end{itemize}
    
    \separation
% ------------------------ %

    \medskip
    \item[2020-07-23] Nouvelle version mineure \verb+0.2.0-beta+.
    
    \begin{itemize}[itemsep=.5em]
        \item \topic*{Arbre}
              ajout de la macro \macro{ptreeFrame} pour tracer facilement des sous cadres non \og finaux \fg.
    \end{itemize}
    
    \separation
% ------------------------ %

    \medskip
    \item[2020-07-22] Nouvelle version mineure \verb+0.1.0-beta+.
    
    \begin{itemize}[itemsep=.5em]
        \item \topic*{Probabilité conditionnelle}
              \macro{probacondexp} renommée en  \macro{eprobacond}.
    
        \item \topic*{Évènement contraire}
              ajout de \macro{nevent}.
    
        \item \topic*{variance et écart-type}
              ajout de \macro{var} et \macro{stddev}.
    \end{itemize}
    
    \separation
% ------------------------ %

    \medskip
    \item[2020-07-10] Première version \verb+0.0.0-beta+.
% ------------------------ %

% Changes shown - END 
\end{description}


\newpage
\section{Toutes les fiches techniques} \label{techincal-ids}












\subsection{Généralités}

\subsubsection{Probabilité \og simple \fg}



\IDmacro{proba}{1}{1}

\IDoption{} le nom de la probabilité. La valeur par défaut est $p$.

\IDarg{} l'ensemble dont on veut calculer la probabilité.


% ---------------------- %


\subsubsection{Probabilité conditionnelle}



\IDmacro{probacond  }{1}{2}

\IDmacro{probacond* }{1}{2}

\extraspace

\IDmacro{eprobacond }{1}{2}

\IDmacro{eprobacond*}{1}{2}


\IDoption{} le nom de la probabilité. La valeur par défaut est $p$.

\IDarg{1} l'ensemble qui donne la condition.

\IDarg{2} l'ensemble dont on veut calculer la probabilité.


\subsubsection{Évènement contraire}



\IDmacro[a]{nevent}{1}

\IDarg{} l'ensemble dont on veut indiquer le contraire.


\subsubsection{Espérance, variance et écart-type}



\IDmacro{expval}{1}{1}

\IDoption{} le nom de la fonction espérance. La valeur par défaut est $\mathrm{E}$ obtenue via \verb#\mathrm{E}#.

\IDarg{} la variable aléatoire dont on veut calculer l'espérance.


\separation


\IDmacro{var}{1}{1}

\IDoption{} le nom de la fonction variance. La valeur par défaut est $\mathrm{V}$ obtenue via \verb#\mathrm{V}#.

\IDarg{} la variable aléatoire dont on veut calculer la variance.


\separation


\IDmacro{stddev}{1}{1}

\IDoption{} le nom de la fonction écart-type. La valeur par défaut est $\sigma$ obtenue via \verb#\sigma#.

\IDarg{} la variable aléatoire dont on veut calculer l'écart-type.














\subsection{Arbres pondérés}



\IDenv[n]{probatree}

\IDenv[n]{probatree*}

\Content{} un arbre codé en utilisant la syntaxe supportée par le package \verb+forest+.

\extraspace

\IDkey{pweight}  pour écrire un poids sur le milieu d'une branche.

\IDkey{apweight} pour écrire un poids au-dessus le milieu d'une branche.

\IDkey{bpweight} pour écrire un poids en-dessous du milieu d'une branche.

\extraspace

\IDkey{pcomment} pour ajouter un commentaire à la droite d'une feuille en utilisant le même alignement horizontal pour tous les commentaires.

\extraspace

\IDkey{pframe} pour encadrer un sous-arbre depuis un noeud vers toutes les feuilles de celui-ci.


\separation


\IDmacro{ptreeFrame}{1}{3} \hfill \mwhyprefix{p}{robabilty}

\IDoption{} la couleur au format TikZ. La valeur par défaut est \verb#blue#.

\IDargs{1..3} noms de la sous-racine (à gauche), du noeud final en haut (à droite) et du noeud final en bas (à droite). Ici l'ordre n'est pas important.


\separation


\IDmacro{ptreeFocus  }{1}{2}

\IDmacro{ptreeFocus* }{1}{2}

\IDmacro{ptreeFocus**}{1}{2}

\IDoption{} la couleur au format TikZ. La valeur par défaut est \verb#blue#.

\IDarg{1} nom du noeud initial.

\IDarg{2} nom du noeud final.




\end{document}
